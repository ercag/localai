{"version":3,"file":"extension.js","mappings":"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","sources":["webpack://localai/./src/memory.ts","webpack://localai/./src/extension.ts","webpack://localai/external node-commonjs \"child_process\"","webpack://localai/./src/chatPanel.ts","webpack://localai/external commonjs \"vscode\"","webpack://localai/./src/ollama.ts","webpack://localai/./src/tools.ts","webpack://localai/external node-commonjs \"os\"","webpack://localai/external node-commonjs \"fs\"","webpack://localai/external node-commonjs \"path\"","webpack://localai/webpack/bootstrap","webpack://localai/webpack/startup"],"sourcesContent":["import * as vscode from 'vscode';\nimport { OllamaMessage } from './ollama';\n\nexport interface ChatSession {\n    id: string;\n    title: string;\n    messages: OllamaMessage[];\n    model: string;\n    createdAt: number;\n    updatedAt: number;\n}\n\nexport interface ProjectMemory {\n    // Key files and their purposes\n    knownFiles: Map<string, string>;\n    // Project summary/notes\n    projectNotes: string;\n    // Frequently used commands\n    commonCommands: string[];\n    // Last updated\n    updatedAt: number;\n}\n\nconst CHAT_HISTORY_KEY = 'localai.chatHistory';\nconst CURRENT_SESSION_KEY = 'localai.currentSession';\nconst PROJECT_MEMORY_KEY = 'localai.projectMemory';\n\nexport class MemoryService {\n    private context: vscode.ExtensionContext;\n    private currentSession: ChatSession | null = null;\n\n    constructor(context: vscode.ExtensionContext) {\n        this.context = context;\n    }\n\n    // ========== Chat Sessions ==========\n\n    async createNewSession(model: string): Promise<ChatSession> {\n        const session: ChatSession = {\n            id: `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            title: 'New Chat',\n            messages: [],\n            model,\n            createdAt: Date.now(),\n            updatedAt: Date.now()\n        };\n        this.currentSession = session;\n        await this.saveCurrentSessionId(session.id);\n        return session;\n    }\n\n    getCurrentSession(): ChatSession | null {\n        return this.currentSession;\n    }\n\n    async loadCurrentSession(): Promise<ChatSession | null> {\n        const sessionId = this.context.workspaceState.get<string>(CURRENT_SESSION_KEY);\n        if (!sessionId) return null;\n\n        const sessions = await this.getAllSessions();\n        const session = sessions.find(s => s.id === sessionId);\n        if (session) {\n            this.currentSession = session;\n        }\n        return session || null;\n    }\n\n    async saveSession(session: ChatSession): Promise<void> {\n        session.updatedAt = Date.now();\n\n        // Auto-generate title from first user message\n        if (session.title === 'New Chat' && session.messages.length > 0) {\n            const firstUserMsg = session.messages.find(m => m.role === 'user');\n            if (firstUserMsg) {\n                session.title = firstUserMsg.content.substring(0, 40) + (firstUserMsg.content.length > 40 ? '...' : '');\n            }\n        }\n\n        const sessions = await this.getAllSessions();\n        const existingIndex = sessions.findIndex(s => s.id === session.id);\n\n        if (existingIndex >= 0) {\n            sessions[existingIndex] = session;\n        } else {\n            sessions.unshift(session);\n        }\n\n        // Keep only last 50 sessions\n        const trimmedSessions = sessions.slice(0, 50);\n        await this.context.workspaceState.update(CHAT_HISTORY_KEY, trimmedSessions);\n\n        this.currentSession = session;\n    }\n\n    async getAllSessions(): Promise<ChatSession[]> {\n        return this.context.workspaceState.get<ChatSession[]>(CHAT_HISTORY_KEY) || [];\n    }\n\n    async deleteSession(sessionId: string): Promise<void> {\n        const sessions = await this.getAllSessions();\n        const filtered = sessions.filter(s => s.id !== sessionId);\n        await this.context.workspaceState.update(CHAT_HISTORY_KEY, filtered);\n\n        if (this.currentSession?.id === sessionId) {\n            this.currentSession = null;\n            await this.context.workspaceState.update(CURRENT_SESSION_KEY, undefined);\n        }\n    }\n\n    async clearAllSessions(): Promise<void> {\n        await this.context.workspaceState.update(CHAT_HISTORY_KEY, []);\n        await this.context.workspaceState.update(CURRENT_SESSION_KEY, undefined);\n        this.currentSession = null;\n    }\n\n    private async saveCurrentSessionId(sessionId: string): Promise<void> {\n        await this.context.workspaceState.update(CURRENT_SESSION_KEY, sessionId);\n    }\n\n    // ========== Messages ==========\n\n    async addMessage(message: OllamaMessage): Promise<void> {\n        if (!this.currentSession) return;\n\n        this.currentSession.messages.push(message);\n        await this.saveSession(this.currentSession);\n    }\n\n    async getMessages(): Promise<OllamaMessage[]> {\n        return this.currentSession?.messages || [];\n    }\n\n    async clearCurrentMessages(): Promise<void> {\n        if (this.currentSession) {\n            this.currentSession.messages = [];\n            await this.saveSession(this.currentSession);\n        }\n    }\n\n    // ========== Project Memory ==========\n\n    async getProjectMemory(): Promise<ProjectMemory | null> {\n        const data = this.context.workspaceState.get<any>(PROJECT_MEMORY_KEY);\n        if (!data) return null;\n\n        return {\n            knownFiles: new Map(Object.entries(data.knownFiles || {})),\n            projectNotes: data.projectNotes || '',\n            commonCommands: data.commonCommands || [],\n            updatedAt: data.updatedAt || Date.now()\n        };\n    }\n\n    async saveProjectMemory(memory: ProjectMemory): Promise<void> {\n        const data = {\n            knownFiles: Object.fromEntries(memory.knownFiles),\n            projectNotes: memory.projectNotes,\n            commonCommands: memory.commonCommands,\n            updatedAt: Date.now()\n        };\n        await this.context.workspaceState.update(PROJECT_MEMORY_KEY, data);\n    }\n\n    async addFileNote(filePath: string, note: string): Promise<void> {\n        let memory = await this.getProjectMemory();\n        if (!memory) {\n            memory = {\n                knownFiles: new Map(),\n                projectNotes: '',\n                commonCommands: [],\n                updatedAt: Date.now()\n            };\n        }\n        memory.knownFiles.set(filePath, note);\n        await this.saveProjectMemory(memory);\n    }\n\n    async setProjectNotes(notes: string): Promise<void> {\n        let memory = await this.getProjectMemory();\n        if (!memory) {\n            memory = {\n                knownFiles: new Map(),\n                projectNotes: '',\n                commonCommands: [],\n                updatedAt: Date.now()\n            };\n        }\n        memory.projectNotes = notes;\n        await this.saveProjectMemory(memory);\n    }\n\n    async addCommonCommand(command: string): Promise<void> {\n        let memory = await this.getProjectMemory();\n        if (!memory) {\n            memory = {\n                knownFiles: new Map(),\n                projectNotes: '',\n                commonCommands: [],\n                updatedAt: Date.now()\n            };\n        }\n        if (!memory.commonCommands.includes(command)) {\n            memory.commonCommands.unshift(command);\n            memory.commonCommands = memory.commonCommands.slice(0, 20);\n            await this.saveProjectMemory(memory);\n        }\n    }\n\n    // ========== Context for LLM ==========\n\n    async getContextSummary(): Promise<string> {\n        const memory = await this.getProjectMemory();\n        if (!memory) return '';\n\n        const parts: string[] = [];\n\n        if (memory.projectNotes) {\n            parts.push(`## Project Notes\\n${memory.projectNotes}`);\n        }\n\n        if (memory.knownFiles.size > 0) {\n            const files = Array.from(memory.knownFiles.entries())\n                .map(([path, note]) => `- ${path}: ${note}`)\n                .join('\\n');\n            parts.push(`## Known Files\\n${files}`);\n        }\n\n        if (memory.commonCommands.length > 0) {\n            parts.push(`## Common Commands\\n${memory.commonCommands.join(', ')}`);\n        }\n\n        return parts.length > 0 ? parts.join('\\n\\n') : '';\n    }\n\n    // ========== Export/Import ==========\n\n    async exportHistory(): Promise<string> {\n        const sessions = await this.getAllSessions();\n        const memory = await this.getProjectMemory();\n\n        const exportData = {\n            exportedAt: new Date().toISOString(),\n            sessions,\n            projectMemory: memory ? {\n                knownFiles: Object.fromEntries(memory.knownFiles),\n                projectNotes: memory.projectNotes,\n                commonCommands: memory.commonCommands\n            } : null\n        };\n\n        return JSON.stringify(exportData, null, 2);\n    }\n\n    async importHistory(jsonData: string): Promise<{ sessions: number; success: boolean }> {\n        try {\n            const data = JSON.parse(jsonData);\n\n            if (data.sessions && Array.isArray(data.sessions)) {\n                await this.context.workspaceState.update(CHAT_HISTORY_KEY, data.sessions);\n            }\n\n            if (data.projectMemory) {\n                const memory: ProjectMemory = {\n                    knownFiles: new Map(Object.entries(data.projectMemory.knownFiles || {})),\n                    projectNotes: data.projectMemory.projectNotes || '',\n                    commonCommands: data.projectMemory.commonCommands || [],\n                    updatedAt: Date.now()\n                };\n                await this.saveProjectMemory(memory);\n            }\n\n            return { sessions: data.sessions?.length || 0, success: true };\n        } catch {\n            return { sessions: 0, success: false };\n        }\n    }\n}\n","import * as vscode from 'vscode';\nimport { ChatPanel } from './chatPanel';\nimport { MemoryService } from './memory';\nimport { getPendingEditForFile, applyPendingEdit, rejectPendingEdit, onPendingEditsChanged, getPendingEditsCount, getAllPendingEdits } from './tools';\n\n// Status bar item for showing generation status\nlet statusBarItem: vscode.StatusBarItem;\n\n// Memory service (shared with ChatPanel)\nlet memoryService: MemoryService;\n\nexport function activate(context: vscode.ExtensionContext) {\n\tconsole.log('LocalAI extension is now active!');\n\n\t// Create status bar item\n\tstatusBarItem = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left, 100);\n\tstatusBarItem.name = 'LocalAI Status';\n\tcontext.subscriptions.push(statusBarItem);\n\n\t// Initialize memory service\n\tmemoryService = new MemoryService(context);\n\n\t// Command to open chat in editor panel\n\tconst openChatCommand = vscode.commands.registerCommand('localai.openChat', () => {\n\t\tChatPanel.createOrShow(context.extensionUri, memoryService);\n\t});\n\n\t// Apply edit command (for diff editor toolbar)\n\tconst applyEditCommand = vscode.commands.registerCommand('localai.applyEdit', async () => {\n\t\t// Önce aktif editor'dan bulmayı dene\n\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\tlet pendingEdit = activeEditor ? getPendingEditForFile(activeEditor.document.uri.fsPath) : undefined;\n\n\t\t// Bulunamadıysa, en son pending edit'i al\n\t\tif (!pendingEdit) {\n\t\t\tconst allEdits = getAllPendingEdits();\n\t\t\tif (allEdits.length > 0) {\n\t\t\t\tpendingEdit = allEdits[allEdits.length - 1];\n\t\t\t}\n\t\t}\n\n\t\tif (pendingEdit) {\n\t\t\tconst result = await applyPendingEdit(pendingEdit.id);\n\t\t\tvscode.window.showInformationMessage(result);\n\t\t\tupdatePendingEditContext();\n\t\t} else {\n\t\t\tvscode.window.showWarningMessage('No pending edit found');\n\t\t}\n\t});\n\n\t// Reject edit command (for diff editor toolbar)\n\tconst rejectEditCommand = vscode.commands.registerCommand('localai.rejectEdit', async () => {\n\t\t// Önce aktif editor'dan bulmayı dene\n\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\tlet pendingEdit = activeEditor ? getPendingEditForFile(activeEditor.document.uri.fsPath) : undefined;\n\n\t\t// Bulunamadıysa, en son pending edit'i al\n\t\tif (!pendingEdit) {\n\t\t\tconst allEdits = getAllPendingEdits();\n\t\t\tif (allEdits.length > 0) {\n\t\t\t\tpendingEdit = allEdits[allEdits.length - 1];\n\t\t\t}\n\t\t}\n\n\t\tif (pendingEdit) {\n\t\t\tconst result = await rejectPendingEdit(pendingEdit.id);\n\t\t\tvscode.window.showInformationMessage(result);\n\t\t\tupdatePendingEditContext();\n\t\t} else {\n\t\t\tvscode.window.showWarningMessage('No pending edit found');\n\t\t}\n\t});\n\n\t// Update context when pending edits change\n\tfunction updatePendingEditContext() {\n\t\t// Herhangi bir pending edit varsa butonları göster\n\t\tconst hasPending = getPendingEditsCount() > 0;\n\t\tvscode.commands.executeCommand('setContext', 'localai.hasPendingEdit', hasPending);\n\t}\n\n\t// Listen to editor changes to update context\n\tcontext.subscriptions.push(\n\t\tvscode.window.onDidChangeActiveTextEditor(() => {\n\t\t\tupdatePendingEditContext();\n\t\t})\n\t);\n\n\t// Listen to pending edits changes\n\tcontext.subscriptions.push(\n\t\tonPendingEditsChanged(() => {\n\t\t\tupdatePendingEditContext();\n\t\t})\n\t);\n\n\t// Stop generation command (for status bar click)\n\tconst stopGenerationCommand = vscode.commands.registerCommand('localai.stopGeneration', () => {\n\t\t// ChatPanel'a stop mesajı gönder\n\t\tif (ChatPanel.currentPanel) {\n\t\t\tChatPanel.currentPanel.stopGeneration();\n\t\t}\n\t});\n\n\tcontext.subscriptions.push(openChatCommand, applyEditCommand, rejectEditCommand, stopGenerationCommand);\n}\n\nexport function deactivate() {\n\tif (ChatPanel.currentPanel) {\n\t\tChatPanel.currentPanel.dispose();\n\t}\n}\n\n// Status bar update functions\nexport function showGeneratingStatus(model: string): void {\n\tif (statusBarItem) {\n\t\tstatusBarItem.text = `$(sync~spin) LocalAI: Generating...`;\n\t\tstatusBarItem.tooltip = `Model: ${model}\\nClick to stop`;\n\t\tstatusBarItem.backgroundColor = new vscode.ThemeColor('statusBarItem.warningBackground');\n\t\tstatusBarItem.command = 'localai.stopGeneration';\n\t\tstatusBarItem.show();\n\t}\n}\n\nexport function updateGeneratingStatus(elapsed: number): void {\n\tif (statusBarItem) {\n\t\tstatusBarItem.text = `$(sync~spin) LocalAI: ${elapsed}s`;\n\t\tif (elapsed >= 60) {\n\t\t\tstatusBarItem.text = `$(warning) LocalAI: ${elapsed}s - slow response`;\n\t\t\tstatusBarItem.backgroundColor = new vscode.ThemeColor('statusBarItem.errorBackground');\n\t\t}\n\t}\n}\n\nexport function hideGeneratingStatus(): void {\n\tif (statusBarItem) {\n\t\tstatusBarItem.hide();\n\t}\n}\n\nexport function showReadyStatus(): void {\n\tif (statusBarItem) {\n\t\tstatusBarItem.text = `$(check) LocalAI: Ready`;\n\t\tstatusBarItem.tooltip = 'LocalAI is ready';\n\t\tstatusBarItem.backgroundColor = undefined;\n\t\tstatusBarItem.command = undefined;\n\t\tstatusBarItem.show();\n\t\t// 3 saniye sonra gizle\n\t\tsetTimeout(() => {\n\t\t\tif (statusBarItem.text === '$(check) LocalAI: Ready') {\n\t\t\t\tstatusBarItem.hide();\n\t\t\t}\n\t\t}, 3000);\n\t}\n}\n","module.exports = require(\"child_process\");","import * as vscode from 'vscode';\nimport { OllamaService, OllamaMessage } from './ollama';\nimport { getOllamaTools, getSystemPrompt, executeTool, applyPendingEdit, rejectPendingEdit, applyAllPendingEdits, rejectAllPendingEdits, getPendingEditsCount, onPendingEditsChanged } from './tools';\nimport { MemoryService, ChatSession } from './memory';\nimport { showGeneratingStatus, updateGeneratingStatus, hideGeneratingStatus, showReadyStatus } from './extension';\n\nexport class ChatPanel {\n    public static currentPanel: ChatPanel | undefined;\n    private readonly panel: vscode.WebviewPanel;\n    private readonly extensionUri: vscode.Uri;\n    private readonly ollama: OllamaService;\n    private messages: OllamaMessage[] = [];\n    private agentModel: string = '';\n    private coderModel: string = '';\n    private abortController: AbortController | null = null;\n    private memory: MemoryService;\n    private currentSession: ChatSession | null = null;\n    private waitingForApproval: boolean = false;\n    private lastPendingCount: number = 0;\n    private autoApproveMode: boolean = false;\n    private disposables: vscode.Disposable[] = [];\n\n    private constructor(panel: vscode.WebviewPanel, extensionUri: vscode.Uri, memoryService: MemoryService) {\n        this.panel = panel;\n        this.extensionUri = extensionUri;\n        this.ollama = new OllamaService();\n        this.memory = memoryService;\n\n        this.panel.webview.html = this.getHtmlContent();\n\n        // Pending edit değişikliklerini dinle\n        onPendingEditsChanged(() => {\n            const currentCount = getPendingEditsCount();\n            if (this.waitingForApproval && currentCount < this.lastPendingCount) {\n                this.waitingForApproval = false;\n                this.continueAfterApproval();\n            }\n            this.lastPendingCount = currentCount;\n            this.updatePendingEditsCount();\n        });\n\n        this.panel.webview.onDidReceiveMessage(\n            async (message) => {\n                switch (message.command) {\n                    case 'sendMessage':\n                        await this.handleUserMessage(message.text, message.context);\n                        break;\n                    case 'selectAgentModel':\n                        this.agentModel = message.model;\n                        break;\n                    case 'selectCoderModel':\n                        this.coderModel = message.model;\n                        break;\n                    case 'getModels':\n                        await this.sendModelList();\n                        break;\n                    case 'updateApiUrl':\n                        this.ollama.setBaseUrl(message.url);\n                        await this.sendModelList();\n                        break;\n                    case 'clearChat':\n                        this.messages = [];\n                        await this.memory.clearCurrentMessages();\n                        break;\n                    case 'newSession':\n                        this.messages = [];\n                        this.currentSession = await this.memory.createNewSession(this.agentModel);\n                        break;\n                    case 'loadSession':\n                        await this.loadSession(message.sessionId);\n                        break;\n                    case 'getSessions':\n                        await this.sendSessionList();\n                        break;\n                    case 'deleteSession':\n                        await this.memory.deleteSession(message.sessionId);\n                        await this.sendSessionList();\n                        break;\n                    case 'stopGeneration':\n                        this.stopGeneration();\n                        break;\n                    case 'ready':\n                        await this.sendModelList();\n                        await this.initSession();\n                        await this.sendSessionList();\n                        if (this.currentSession && this.messages.length > 0) {\n                            this.panel.webview.postMessage({\n                                command: 'loadedSession',\n                                session: {\n                                    id: this.currentSession.id,\n                                    title: this.currentSession.title,\n                                    model: this.currentSession.model,\n                                    messageCount: this.messages.length\n                                },\n                                messages: this.messages.filter(m => m.role === 'user' || m.role === 'assistant')\n                            });\n                        }\n                        break;\n                    case 'approveEdit':\n                        const approveResult = await applyPendingEdit(message.editId);\n                        this.panel.webview.postMessage({\n                            command: 'editResult',\n                            editId: message.editId,\n                            result: approveResult,\n                            approved: true\n                        });\n                        this.updatePendingEditsCount();\n                        if (approveResult.includes('✓') && this.waitingForApproval) {\n                            this.waitingForApproval = false;\n                            await this.continueAfterApproval();\n                        }\n                        break;\n                    case 'rejectEdit':\n                        const rejectResult = await rejectPendingEdit(message.editId);\n                        this.panel.webview.postMessage({\n                            command: 'editResult',\n                            editId: message.editId,\n                            result: rejectResult,\n                            approved: false\n                        });\n                        this.updatePendingEditsCount();\n                        break;\n                    case 'approveAllEdits':\n                        const approveAllResult = await applyAllPendingEdits();\n                        this.panel.webview.postMessage({\n                            command: 'bulkEditResult',\n                            result: approveAllResult,\n                            approved: true\n                        });\n                        this.updatePendingEditsCount();\n                        break;\n                    case 'rejectAllEdits':\n                        const rejectAllResult = rejectAllPendingEdits();\n                        this.panel.webview.postMessage({\n                            command: 'bulkEditResult',\n                            result: rejectAllResult,\n                            approved: false\n                        });\n                        this.updatePendingEditsCount();\n                        break;\n                    case 'setAutoApprove':\n                        this.autoApproveMode = message.enabled;\n                        if (this.autoApproveMode && this.waitingForApproval) {\n                            // Hemen bekleyen editleri onayla\n                            await applyAllPendingEdits();\n                            this.waitingForApproval = false;\n                            this.updatePendingEditsCount();\n                            await this.continueAfterApproval();\n                        }\n                        break;\n                    case 'getContext':\n                        await this.handleGetContext(message.type, message.value);\n                        break;\n                    case 'openFile':\n                        this.openFile(message.path, message.line);\n                        break;\n                }\n            },\n            null,\n            this.disposables\n        );\n\n        this.panel.onDidDispose(() => this.dispose(), null, this.disposables);\n    }\n\n    public static createOrShow(extensionUri: vscode.Uri, memoryService: MemoryService): ChatPanel {\n        const column = vscode.ViewColumn.Beside;\n\n        if (ChatPanel.currentPanel) {\n            ChatPanel.currentPanel.panel.reveal(column);\n            return ChatPanel.currentPanel;\n        }\n\n        const panel = vscode.window.createWebviewPanel(\n            'localaiChat',\n            'LocalAI',\n            column,\n            {\n                enableScripts: true,\n                retainContextWhenHidden: true,\n                localResourceRoots: [extensionUri]\n            }\n        );\n\n        ChatPanel.currentPanel = new ChatPanel(panel, extensionUri, memoryService);\n        return ChatPanel.currentPanel;\n    }\n\n    public stopGeneration(): void {\n        if (this.abortController) {\n            this.abortController.abort();\n            this.abortController = null;\n        }\n        this.waitingForApproval = false;\n        hideGeneratingStatus();\n        this.panel.webview.postMessage({ command: 'endResponse' });\n    }\n\n    private async initSession(): Promise<void> {\n        const existingSession = await this.memory.loadCurrentSession();\n        if (existingSession) {\n            this.currentSession = existingSession;\n            this.messages = existingSession.messages;\n            this.agentModel = existingSession.model;\n        } else {\n            this.currentSession = await this.memory.createNewSession(this.agentModel);\n        }\n    }\n\n    private async loadSession(sessionId: string): Promise<void> {\n        const sessions = await this.memory.getAllSessions();\n        const session = sessions.find(s => s.id === sessionId);\n        if (session) {\n            this.currentSession = session;\n            this.messages = session.messages;\n            this.agentModel = session.model;\n            this.panel.webview.postMessage({\n                command: 'loadedSession',\n                session: { id: session.id, title: session.title, model: session.model, messageCount: session.messages.length },\n                messages: session.messages.filter(m => m.role === 'user' || m.role === 'assistant')\n            });\n        }\n    }\n\n    private async sendSessionList(): Promise<void> {\n        const sessions = await this.memory.getAllSessions();\n        this.panel.webview.postMessage({\n            command: 'sessionList',\n            sessions: sessions.map(s => ({\n                id: s.id, title: s.title, model: s.model,\n                messageCount: s.messages.length, updatedAt: s.updatedAt\n            })),\n            currentSessionId: this.currentSession?.id\n        });\n    }\n\n    private async saveCurrentSession(): Promise<void> {\n        if (this.currentSession) {\n            this.currentSession.messages = this.messages;\n            this.currentSession.model = this.agentModel;\n            await this.memory.saveSession(this.currentSession);\n        }\n    }\n\n    private updatePendingEditsCount(): void {\n        this.panel.webview.postMessage({\n            command: 'pendingEditsCount',\n            count: getPendingEditsCount()\n        });\n    }\n\n    private async handleGetContext(type: string, value: string): Promise<void> {\n        let content = '';\n        const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n\n        try {\n            if (type === 'special') {\n                if (value === '@selection') {\n                    const editor = vscode.window.activeTextEditor;\n                    if (editor) {\n                        content = editor.document.getText(editor.selection) || '(No text selected)';\n                    }\n                } else if (value === '@file') {\n                    const editor = vscode.window.activeTextEditor;\n                    if (editor) {\n                        content = `File: ${editor.document.fileName}\\n${'─'.repeat(40)}\\n${editor.document.getText()}`;\n                    }\n                } else if (value === '@errors') {\n                    const editor = vscode.window.activeTextEditor;\n                    if (editor) {\n                        const diagnostics = vscode.languages.getDiagnostics(editor.document.uri);\n                        content = diagnostics.length > 0\n                            ? diagnostics.map(d => `Line ${d.range.start.line + 1}: [${d.severity === 0 ? 'Error' : 'Warning'}] ${d.message}`).join('\\n')\n                            : '(No errors in current file)';\n                    }\n                }\n            } else if (type === 'file' && workspaceRoot) {\n                const filePath = value.replace('@file:', '');\n                const fullPath = require('path').join(workspaceRoot, filePath);\n                const fs = require('fs');\n                if (fs.existsSync(fullPath)) {\n                    content = `File: ${filePath}\\n${'─'.repeat(40)}\\n${fs.readFileSync(fullPath, 'utf-8')}`;\n                }\n            }\n        } catch (error) {\n            content = `(Error: ${error instanceof Error ? error.message : 'Unknown'})`;\n        }\n\n        this.panel.webview.postMessage({ command: 'contextData', value, content });\n    }\n\n    private async openFile(filePath: string, line?: number): Promise<void> {\n        const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n        if (!workspaceRoot) return;\n\n        const fullPath = vscode.Uri.file(\n            filePath.startsWith('/') || filePath.includes(':') ? filePath : `${workspaceRoot}/${filePath}`\n        );\n\n        try {\n            const doc = await vscode.workspace.openTextDocument(fullPath);\n            const editor = await vscode.window.showTextDocument(doc);\n            if (line && line > 0) {\n                const position = new vscode.Position(line - 1, 0);\n                editor.selection = new vscode.Selection(position, position);\n                editor.revealRange(new vscode.Range(position, position), vscode.TextEditorRevealType.InCenter);\n            }\n        } catch {\n            vscode.window.showErrorMessage(`Could not open file: ${filePath}`);\n        }\n    }\n\n    private async sendModelList(): Promise<void> {\n        try {\n            const models = await this.ollama.listModels();\n            const toolCapable = ['llama3.1', 'llama3.2', 'llama3.3', 'mistral'];\n            if (models.length > 0 && !this.agentModel) {\n                this.agentModel = models.find(m => toolCapable.some(tc => m.toLowerCase().includes(tc))) || models[0];\n            }\n            if (models.length > 0 && !this.coderModel) {\n                this.coderModel = models.find(m => m.toLowerCase().includes('coder') || m.toLowerCase().includes('qwen')) || '';\n            }\n            this.panel.webview.postMessage({\n                command: 'modelList', models, agentModel: this.agentModel, coderModel: this.coderModel\n            });\n        } catch (error) {\n            this.panel.webview.postMessage({\n                command: 'error',\n                text: 'Ollama bağlantısı kurulamadı. ollama serve çalışıyor mu?'\n            });\n        }\n    }\n\n    private async handleUserMessage(text: string, context?: Array<{type: string; value: string; label: string; content: string}>): Promise<void> {\n        let fullMessage = text;\n        if (context && context.length > 0) {\n            const contextParts = context.filter(c => c.content).map(c => `[${c.label}]\\n${c.content}`);\n            if (contextParts.length > 0) {\n                fullMessage = `Context:\\n${contextParts.join('\\n\\n')}\\n\\nUser request: ${text}`;\n            }\n        }\n\n        this.messages.push({ role: 'user', content: fullMessage });\n        await this.saveCurrentSession();\n\n        this.panel.webview.postMessage({ command: 'addMessage', role: 'user', content: text });\n        this.panel.webview.postMessage({ command: 'startResponse' });\n\n        try {\n            await this.runAgentLoop();\n        } catch (error) {\n            hideGeneratingStatus();\n            if ((error as Error).name === 'AbortError') {\n                this.panel.webview.postMessage({ command: 'appendToken', token: '\\n\\n*[Durduruldu]*' });\n            } else {\n                this.panel.webview.postMessage({ command: 'error', text: error instanceof Error ? error.message : 'Bilinmeyen hata' });\n            }\n        }\n\n        if (!this.waitingForApproval) {\n            this.panel.webview.postMessage({ command: 'endResponse' });\n        }\n    }\n\n    private async runAgentLoop(): Promise<void> {\n        const maxIterations = 10;\n        let iteration = 0;\n        let statusUpdateInterval: NodeJS.Timeout | null = null;\n        const loopStartTime = Date.now();\n\n        this.abortController = new AbortController();\n\n        const activeAgentModel = this.agentModel || this.coderModel;\n        if (!activeAgentModel) {\n            throw new Error('Lütfen en az bir model seçin');\n        }\n\n        showGeneratingStatus(activeAgentModel);\n        statusUpdateInterval = setInterval(() => {\n            updateGeneratingStatus(Math.floor((Date.now() - loopStartTime) / 1000));\n        }, 1000);\n\n        try {\n            while (iteration < maxIterations) {\n                if (this.abortController?.signal.aborted) {\n                    throw new DOMException('Aborted', 'AbortError');\n                }\n\n                iteration++;\n\n                const messagesWithSystem: OllamaMessage[] = [\n                    { role: 'system', content: getSystemPrompt() },\n                    ...this.messages\n                ];\n\n                const tools = getOllamaTools();\n\n                const { content, toolCalls } = await this.ollama.chatWithTools(\n                    activeAgentModel,\n                    messagesWithSystem,\n                    tools,\n                    (token) => {\n                        this.panel.webview.postMessage({ command: 'appendToken', token });\n                    },\n                    this.abortController.signal\n                );\n\n                if (toolCalls && toolCalls.length > 0) {\n                    this.messages.push({ role: 'assistant', content, tool_calls: toolCalls });\n                    this.panel.webview.postMessage({ command: 'endResponse' });\n\n                    for (const toolCall of toolCalls) {\n                        if (this.abortController?.signal.aborted) {\n                            throw new DOMException('Aborted', 'AbortError');\n                        }\n\n                        const toolName = toolCall.function.name;\n                        let toolParams = toolCall.function.arguments;\n\n                        // Coder model için kod üretimi\n                        const needsCodeGeneration = ['write_file', 'edit_file'].includes(toolName)\n                            && this.coderModel && this.coderModel !== this.agentModel\n                            && (!toolParams.content || toolParams.content.length < 50);\n\n                        if (needsCodeGeneration) {\n                            this.panel.webview.postMessage({ command: 'startCodeGeneration', coderModel: this.coderModel });\n                            const codeContent = await this.generateCodeWithCoderModel(toolName, toolParams);\n                            if (codeContent) toolParams = { ...toolParams, content: codeContent };\n                            this.panel.webview.postMessage({ command: 'endCodeGeneration' });\n                        }\n\n                        const displayParams = { ...toolParams };\n                        if (['write_file', 'edit_file'].includes(toolName)) {\n                            if (displayParams.content) displayParams.content = `[${displayParams.content.split('\\n').length} satır]`;\n                            if (displayParams.new_text) displayParams.new_text = `[${displayParams.new_text.split('\\n').length} satır]`;\n                            if (displayParams.old_text) displayParams.old_text = `[${displayParams.old_text.split('\\n').length} satır]`;\n                        }\n\n                        this.panel.webview.postMessage({ command: 'toolCall', name: toolName, params: displayParams });\n\n                        const toolResult = await executeTool(toolName, toolParams);\n\n                        let displayResult = toolResult;\n                        if (toolName === 'read_file') displayResult = '✓ dosya okundu';\n                        else if (toolName === 'write_file') displayResult = '✓ dosya yazıldı';\n                        else if (toolName === 'edit_file') displayResult = '✓ dosya düzenlendi';\n\n                        this.panel.webview.postMessage({ command: 'toolResult', name: toolName, result: displayResult });\n                        this.messages.push({ role: 'tool', content: toolResult });\n\n                        if (['write_file', 'edit_file'].includes(toolName) && toolResult.includes('PENDING_EDIT')) {\n                            // Auto-approve modunda ise hemen onayla ve devam et\n                            if (this.autoApproveMode) {\n                                await applyAllPendingEdits();\n                                this.updatePendingEditsCount();\n                                this.panel.webview.postMessage({\n                                    command: 'toolResult',\n                                    name: toolName,\n                                    result: '✓ otomatik onaylandı'\n                                });\n                                continue;\n                            }\n\n                            this.waitingForApproval = true;\n                            this.lastPendingCount = getPendingEditsCount();\n                            this.messages.push({ role: 'assistant', content: 'Değişiklikler diff editörde. Onaylayın veya reddedin.' });\n                            await this.saveCurrentSession();\n                            if (statusUpdateInterval) clearInterval(statusUpdateInterval);\n                            hideGeneratingStatus();\n                            this.panel.webview.postMessage({ command: 'endResponse' });\n                            return;\n                        }\n                    }\n\n                    this.panel.webview.postMessage({ command: 'startResponse' });\n                    continue;\n                } else {\n                    this.messages.push({ role: 'assistant', content });\n                    await this.saveCurrentSession();\n                    break;\n                }\n            }\n        } finally {\n            if (statusUpdateInterval) clearInterval(statusUpdateInterval);\n            hideGeneratingStatus();\n            showReadyStatus();\n            this.abortController = null;\n        }\n    }\n\n    private async generateCodeWithCoderModel(toolName: string, params: Record<string, string>): Promise<string | null> {\n        if (!this.coderModel) return null;\n\n        const userMessages = this.messages.filter(m => m.role === 'user');\n        const lastUserMessage = userMessages[userMessages.length - 1]?.content || '';\n\n        const coderPrompt = toolName === 'edit_file'\n            ? `Edit code based on: ${lastUserMessage}\\nFile: ${params.path}\\nOld text: ${params.old_text}\\nProvide ONLY the new code.`\n            : `Generate code for: ${lastUserMessage}\\nFile: ${params.path}\\nProvide ONLY the file content.`;\n\n        try {\n            const codeResult = await this.ollama.chatWithTools(\n                this.coderModel,\n                [{ role: 'user', content: coderPrompt }],\n                [],\n                () => {},\n                this.abortController?.signal\n            );\n\n            let cleanCode = codeResult.content.trim();\n            const codeBlockMatch = cleanCode.match(/```[\\w]*\\n([\\s\\S]*?)```/);\n            if (codeBlockMatch) cleanCode = codeBlockMatch[1].trim();\n            return cleanCode;\n        } catch {\n            return null;\n        }\n    }\n\n    private async continueAfterApproval(): Promise<void> {\n        this.messages.push({ role: 'user', content: '[Değişiklikler onaylandı. Devam et.]' });\n        this.panel.webview.postMessage({ command: 'startResponse' });\n        try {\n            await this.runAgentLoop();\n        } catch (error) {\n            if (!(error instanceof DOMException && error.name === 'AbortError')) {\n                this.panel.webview.postMessage({ command: 'error', text: error instanceof Error ? error.message : 'Hata' });\n            }\n        }\n    }\n\n    private getHtmlContent(): string {\n        return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>LocalAI</title>\n    <style>\n        :root {\n            --bg: #1e1e1e;\n            --bg-light: #252526;\n            --bg-lighter: #2d2d2d;\n            --border: #3c3c3c;\n            --text: #d4d4d4;\n            --text-dim: #808080;\n            --green: #4ec957;\n            --cyan: #56b6c2;\n            --yellow: #e5c07b;\n            --red: #e06c75;\n        }\n        * { box-sizing: border-box; margin: 0; padding: 0; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: var(--bg);\n            color: var(--text);\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            font-size: 13px;\n        }\n        /* Header */\n        .header {\n            padding: 8px 12px;\n            background: var(--bg-light);\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            gap: 8px;\n            align-items: center;\n            flex-wrap: wrap;\n        }\n        .header input, .header select {\n            background: var(--bg-lighter);\n            color: var(--text);\n            border: 1px solid var(--border);\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n        }\n        .header input { flex: 1; min-width: 120px; }\n        .header select { min-width: 100px; }\n        .header button {\n            background: var(--bg-lighter);\n            color: var(--cyan);\n            border: 1px solid var(--border);\n            padding: 4px 12px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n        }\n        .header button:hover { background: var(--border); }\n        .model-row {\n            display: flex;\n            gap: 8px;\n            align-items: center;\n            width: 100%;\n        }\n        .model-label { font-size: 10px; color: var(--cyan); font-weight: bold; }\n        /* Chat */\n        .chat-container {\n            flex: 1;\n            overflow-y: auto;\n            padding: 16px 16px 16px 24px;\n        }\n        .timeline {\n            border-left: 2px solid var(--border);\n            margin-left: 6px;\n            padding-left: 20px;\n        }\n        .timeline-item {\n            position: relative;\n            padding-bottom: 16px;\n        }\n        .timeline-item:last-child { padding-bottom: 24px; }\n        .timeline-dot {\n            position: absolute;\n            left: -27px;\n            top: 4px;\n            width: 10px;\n            height: 10px;\n            border-radius: 50%;\n            background: var(--bg);\n            border: 2px solid var(--text-dim);\n        }\n        .timeline-item.user .timeline-dot {\n            border-color: var(--green);\n            background: var(--green);\n        }\n        .timeline-item.assistant .timeline-dot {\n            border-color: var(--cyan);\n        }\n        .timeline-item.assistant.complete .timeline-dot {\n            background: var(--cyan);\n        }\n        .timeline-item.generating .timeline-dot {\n            background: var(--cyan);\n            animation: pulse 1s ease-in-out infinite;\n        }\n        @keyframes pulse {\n            0%, 100% { opacity: 1; }\n            50% { opacity: 0.3; }\n        }\n        .timeline-item.tool .timeline-dot {\n            width: 6px; height: 6px;\n            left: -25px; top: 6px;\n            border-color: var(--yellow);\n            background: var(--yellow);\n        }\n        .timeline-item.error .timeline-dot {\n            border-color: var(--red);\n            background: var(--red);\n        }\n        .timeline-header {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            margin-bottom: 4px;\n            font-size: 11px;\n        }\n        .timeline-sender { font-weight: 600; }\n        .timeline-item.user .timeline-sender { color: var(--green); }\n        .timeline-item.assistant .timeline-sender { color: var(--cyan); }\n        .timeline-time { color: var(--text-dim); font-size: 10px; }\n        .elapsed-time { color: var(--text-dim); font-size: 10px; }\n        .elapsed-time.warning { color: var(--yellow); }\n        .timeline-content {\n            background: var(--bg-light);\n            border: 1px solid var(--border);\n            border-radius: 6px;\n            padding: 10px 14px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            word-break: break-word;\n        }\n        .timeline-item.user .timeline-content {\n            background: #1a2e1a;\n            border-color: #2d4a2d;\n        }\n        .timeline-item.error .timeline-content {\n            background: #2e1a1a;\n            border-color: #4a2d2d;\n            color: var(--red);\n        }\n        .timeline-item.tool .timeline-content {\n            background: transparent;\n            border: none;\n            padding: 0;\n            font-size: 12px;\n            color: var(--text-dim);\n        }\n        .timeline-item.tool { padding-bottom: 8px; }\n        .generating-content {\n            background: transparent !important;\n            border: none !important;\n            padding: 0 !important;\n        }\n        .generating-dots {\n            display: inline-flex;\n            gap: 3px;\n        }\n        .generating-dots span {\n            width: 5px; height: 5px;\n            background: var(--cyan);\n            border-radius: 50%;\n            animation: wave 1.2s ease-in-out infinite;\n        }\n        .generating-dots span:nth-child(2) { animation-delay: 0.15s; }\n        .generating-dots span:nth-child(3) { animation-delay: 0.3s; }\n        @keyframes wave {\n            0%, 60%, 100% { transform: scale(0.6); opacity: 0.4; }\n            30% { transform: scale(1); opacity: 1; }\n        }\n        .tool-action { color: var(--cyan); }\n        /* Code */\n        pre {\n            background: var(--bg);\n            padding: 10px;\n            border-radius: 4px;\n            overflow-x: auto;\n            margin: 8px 0;\n        }\n        code {\n            font-family: 'Fira Code', Consolas, monospace;\n            font-size: 12px;\n        }\n        /* Input */\n        .input-section {\n            padding: 12px;\n            background: var(--bg);\n            border-top: 1px solid var(--border);\n        }\n        .input-wrapper {\n            display: flex;\n            background: var(--bg-lighter);\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            padding: 8px 12px;\n            gap: 8px;\n            align-items: flex-end;\n        }\n        .input-wrapper:focus-within {\n            border-color: var(--cyan);\n        }\n        .input-section textarea {\n            flex: 1;\n            background: transparent;\n            color: var(--text);\n            border: none;\n            outline: none;\n            font-family: inherit;\n            font-size: 13px;\n            resize: none;\n            min-height: 24px;\n            max-height: 150px;\n        }\n        .input-actions {\n            display: flex;\n            gap: 4px;\n        }\n        .input-actions button {\n            background: transparent;\n            border: none;\n            padding: 4px 8px;\n            cursor: pointer;\n            border-radius: 4px;\n            font-size: 14px;\n        }\n        .input-actions button.stop { color: var(--red); }\n        .input-actions button.send { color: var(--green); }\n        .input-actions button:hover { background: var(--border); }\n        /* Auto-approve toggle */\n        .auto-approve-row {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 6px 12px;\n            background: var(--bg-light);\n            border-top: 1px solid var(--border);\n            font-size: 11px;\n        }\n        .auto-approve-row label {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            cursor: pointer;\n            color: var(--text-dim);\n        }\n        .auto-approve-row input[type=\"checkbox\"] {\n            width: 14px;\n            height: 14px;\n            cursor: pointer;\n        }\n        .auto-approve-row.active label {\n            color: var(--yellow);\n        }\n        .auto-approve-hint {\n            font-size: 10px;\n            color: var(--text-dim);\n            margin-left: auto;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <input type=\"text\" id=\"apiUrl\" value=\"http://localhost:11434\" placeholder=\"Ollama URL\">\n        <button id=\"fetchBtn\">Fetch</button>\n        <button id=\"newBtn\">New</button>\n        <button id=\"historyBtn\">History</button>\n    </div>\n    <div class=\"header model-row\">\n        <span class=\"model-label\">AGENT:</span>\n        <select id=\"agentModel\"><option>Loading...</option></select>\n        <span class=\"model-label\">CODER:</span>\n        <select id=\"coderModel\"><option>Optional</option></select>\n    </div>\n    <div class=\"chat-container\" id=\"chatContainer\">\n        <div class=\"timeline\" id=\"chat\">\n            <div class=\"timeline-item assistant complete\">\n                <div class=\"timeline-dot\"></div>\n                <div class=\"timeline-content\">LocalAI ready. How can I help?</div>\n            </div>\n        </div>\n    </div>\n    <div class=\"auto-approve-row\" id=\"autoApproveRow\">\n        <label>\n            <input type=\"checkbox\" id=\"autoApproveToggle\">\n            <span>Auto-approve edits</span>\n        </label>\n        <span class=\"auto-approve-hint\">Skip diff review for this session</span>\n    </div>\n    <div class=\"input-section\">\n        <div class=\"input-wrapper\">\n            <textarea id=\"input\" rows=\"1\" placeholder=\"Ask anything... (Shift+Enter for new line)\"></textarea>\n            <div class=\"input-actions\">\n                <button id=\"stopBtn\" class=\"stop\" style=\"display:none\">■</button>\n                <button id=\"sendBtn\" class=\"send\">↵</button>\n            </div>\n        </div>\n    </div>\n    <script>\n        const vscode = acquireVsCodeApi();\n        const chat = document.getElementById('chat');\n        const chatContainer = document.getElementById('chatContainer');\n        const input = document.getElementById('input');\n        const stopBtn = document.getElementById('stopBtn');\n        const sendBtn = document.getElementById('sendBtn');\n        const agentModel = document.getElementById('agentModel');\n        const coderModel = document.getElementById('coderModel');\n        const apiUrl = document.getElementById('apiUrl');\n        const fetchBtn = document.getElementById('fetchBtn');\n        const newBtn = document.getElementById('newBtn');\n        const autoApproveToggle = document.getElementById('autoApproveToggle');\n        const autoApproveRow = document.getElementById('autoApproveRow');\n\n        let currentLine = null;\n        let isResponding = false;\n\n        fetchBtn.onclick = () => vscode.postMessage({ command: 'updateApiUrl', url: apiUrl.value.trim() });\n        newBtn.onclick = () => {\n            vscode.postMessage({ command: 'newSession' });\n            chat.innerHTML = '<div class=\"timeline-item assistant complete\"><div class=\"timeline-dot\"></div><div class=\"timeline-content\">New session started.</div></div>';\n            // Reset auto-approve on new session\n            autoApproveToggle.checked = false;\n            autoApproveRow.classList.remove('active');\n            vscode.postMessage({ command: 'setAutoApprove', enabled: false });\n        };\n        autoApproveToggle.onchange = () => {\n            const enabled = autoApproveToggle.checked;\n            autoApproveRow.classList.toggle('active', enabled);\n            vscode.postMessage({ command: 'setAutoApprove', enabled });\n        };\n        stopBtn.onclick = () => vscode.postMessage({ command: 'stopGeneration' });\n        sendBtn.onclick = send;\n        agentModel.onchange = () => vscode.postMessage({ command: 'selectAgentModel', model: agentModel.value });\n        coderModel.onchange = () => vscode.postMessage({ command: 'selectCoderModel', model: coderModel.value });\n\n        input.onkeydown = (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); }\n        };\n        input.oninput = () => {\n            input.style.height = 'auto';\n            input.style.height = Math.min(input.scrollHeight, 150) + 'px';\n        };\n\n        function send() {\n            const text = input.value.trim();\n            if (!text || isResponding) return;\n            vscode.postMessage({ command: 'sendMessage', text });\n            input.value = '';\n            input.style.height = 'auto';\n        }\n\n        function addLine(cls, content, isHtml) {\n            const item = document.createElement('div');\n            item.className = 'timeline-item ' + cls + (cls === 'assistant' ? ' complete' : '');\n\n            const dot = document.createElement('div');\n            dot.className = 'timeline-dot';\n\n            if (cls === 'user' || cls === 'assistant' || cls === 'error') {\n                const header = document.createElement('div');\n                header.className = 'timeline-header';\n                const sender = document.createElement('span');\n                sender.className = 'timeline-sender';\n                sender.textContent = cls === 'user' ? 'You' : cls === 'error' ? 'Error' : 'LocalAI';\n                const time = document.createElement('span');\n                time.className = 'timeline-time';\n                time.textContent = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});\n                header.appendChild(sender);\n                header.appendChild(time);\n                item.appendChild(dot);\n                item.appendChild(header);\n            } else {\n                item.appendChild(dot);\n            }\n\n            const contentDiv = document.createElement('div');\n            contentDiv.className = 'timeline-content';\n            if (isHtml) contentDiv.innerHTML = content;\n            else contentDiv.textContent = content;\n            item.appendChild(contentDiv);\n\n            chat.appendChild(item);\n            chatContainer.scrollTop = chatContainer.scrollHeight;\n            return contentDiv;\n        }\n\n        function escapeHtml(t) { return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }\n        function renderMd(text) {\n            text = text.replace(/\\`\\`\\`(\\\\w*)\\\\n?([\\\\s\\\\S]*?)\\`\\`\\`/g, (m,l,c) => '<pre><code>' + escapeHtml(c.trim()) + '</code></pre>');\n            text = text.replace(/\\`([^\\`]+)\\`/g, '<code>$1</code>');\n            text = text.replace(/\\\\*\\\\*([^*]+)\\\\*\\\\*/g, '<strong>$1</strong>');\n            text = text.replace(/\\\\n/g, '<br>');\n            return text;\n        }\n\n        window.onmessage = (e) => {\n            const msg = e.data;\n            switch(msg.command) {\n                case 'modelList':\n                    agentModel.innerHTML = msg.models.map(m => '<option value=\"'+m+'\"'+(m===msg.agentModel?' selected':'')+'>'+m+'</option>').join('');\n                    coderModel.innerHTML = '<option value=\"\">None</option>' + msg.models.map(m => '<option value=\"'+m+'\"'+(m===msg.coderModel?' selected':'')+'>'+m+'</option>').join('');\n                    break;\n                case 'addMessage':\n                    addLine(msg.role, msg.content);\n                    break;\n                case 'startResponse':\n                    isResponding = true;\n                    stopBtn.style.display = 'inline';\n\n                    var item = document.createElement('div');\n                    item.className = 'timeline-item assistant generating';\n                    item.id = 'current-response';\n\n                    var dot = document.createElement('div');\n                    dot.className = 'timeline-dot';\n\n                    var header = document.createElement('div');\n                    header.className = 'timeline-header';\n                    header.style.display = 'none';\n                    header.innerHTML = '<span class=\"timeline-sender\">LocalAI</span><span class=\"timeline-time\">' + new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) + '</span>';\n\n                    currentLine = document.createElement('div');\n                    currentLine.className = 'timeline-content generating-content';\n                    currentLine._raw = '';\n\n                    item.appendChild(dot);\n                    item.appendChild(header);\n                    item.appendChild(currentLine);\n                    chat.appendChild(item);\n                    chatContainer.scrollTop = chatContainer.scrollHeight;\n                    break;\n                case 'appendToken':\n                    if (currentLine) {\n                        if (currentLine.classList.contains('generating-content')) {\n                            currentLine.classList.remove('generating-content');\n                            var container = document.getElementById('current-response');\n                            if (container) {\n                                var hdr = container.querySelector('.timeline-header');\n                                if (hdr) hdr.style.display = 'flex';\n                            }\n                        }\n                        currentLine._raw += msg.token;\n                        currentLine.innerHTML = renderMd(currentLine._raw) + '<span class=\"generating-dots\"><span></span><span></span><span></span></span>';\n                        chatContainer.scrollTop = chatContainer.scrollHeight;\n                    }\n                    break;\n                case 'endResponse':\n                    var container = document.getElementById('current-response');\n                    if (currentLine && currentLine._raw && currentLine._raw.trim()) {\n                        currentLine.innerHTML = renderMd(currentLine._raw);\n                        if (container) {\n                            container.classList.remove('generating');\n                            container.classList.add('complete');\n                        }\n                    } else if (container) {\n                        container.remove();\n                    }\n                    if (container) container.removeAttribute('id');\n                    isResponding = false;\n                    stopBtn.style.display = 'none';\n                    currentLine = null;\n                    break;\n                case 'toolCall':\n                    var toolDesc = {'read_file':'📖 Reading','write_file':'📝 Writing','edit_file':'✏️ Editing','list_files':'📁 Listing','search_files':'🔍 Searching','run_terminal_command':'💻 Running'}[msg.name] || '🔧 ' + msg.name;\n                    var detail = msg.params?.path || msg.params?.pattern || msg.params?.command || '';\n                    if (detail.length > 40) detail = detail.substring(0,40) + '...';\n                    addLine('tool', '<span class=\"tool-action\">' + toolDesc + '</span>' + (detail ? ': ' + escapeHtml(detail) : ''), true);\n                    break;\n                case 'toolResult':\n                    break;\n                case 'error':\n                    isResponding = false;\n                    stopBtn.style.display = 'none';\n                    var container = document.getElementById('current-response');\n                    if (container) container.remove();\n                    currentLine = null;\n                    addLine('error', msg.text);\n                    break;\n            }\n        };\n\n        setTimeout(() => vscode.postMessage({ command: 'ready' }), 300);\n    </script>\n</body>\n</html>`;\n    }\n\n    public dispose(): void {\n        ChatPanel.currentPanel = undefined;\n        this.panel.dispose();\n        while (this.disposables.length) {\n            const d = this.disposables.pop();\n            if (d) d.dispose();\n        }\n    }\n}\n","module.exports = require(\"vscode\");","import * as vscode from 'vscode';\n\nexport interface OllamaMessage {\n    role: 'user' | 'assistant' | 'system' | 'tool';\n    content: string;\n    tool_calls?: ToolCall[];\n}\n\nexport interface ToolCall {\n    function: {\n        name: string;\n        arguments: Record<string, string>;\n    };\n}\n\nexport interface OllamaTool {\n    type: 'function';\n    function: {\n        name: string;\n        description: string;\n        parameters: {\n            type: string;\n            properties: Record<string, { type: string; description: string }>;\n            required: string[];\n        };\n    };\n}\n\ninterface OllamaChatResponse {\n    message: {\n        role: string;\n        content: string;\n        tool_calls?: ToolCall[];\n    };\n    done: boolean;\n}\n\nexport class OllamaService {\n    private baseUrl: string;\n\n    constructor() {\n        this.baseUrl = this.getBaseUrl();\n    }\n\n    private getBaseUrl(): string {\n        const config = vscode.workspace.getConfiguration('localai');\n        return config.get<string>('ollamaUrl') || 'http://localhost:11434';\n    }\n\n    public updateBaseUrl(): void {\n        this.baseUrl = this.getBaseUrl();\n    }\n\n    public setBaseUrl(url: string): void {\n        this.baseUrl = url;\n    }\n\n    public getCurrentUrl(): string {\n        return this.baseUrl;\n    }\n\n    async chatWithTools(\n        model: string,\n        messages: OllamaMessage[],\n        tools: OllamaTool[],\n        onToken?: (token: string) => void,\n        signal?: AbortSignal\n    ): Promise<{ content: string; toolCalls: ToolCall[] }> {\n        const url = `${this.baseUrl}/api/chat`;\n\n        // Tool kullanımında streaming'i kapat (daha güvenilir tool calling için)\n        const useStreaming = tools.length === 0;\n\n        const requestBody = {\n            model,\n            messages,\n            tools: tools.length > 0 ? tools : undefined,\n            stream: useStreaming,\n        };\n\n        console.log('[LocalAI] Chat request:', {\n            url,\n            model,\n            messageCount: messages.length,\n            toolCount: tools.length,\n            toolNames: tools.map(t => t.function.name)\n        });\n\n        // Retry mekanizması - model yüklenirken 500 hatası alınabilir\n        const maxRetries = 3;\n        let lastError: Error | null = null;\n\n        for (let attempt = 1; attempt <= maxRetries; attempt++) {\n            try {\n                const response = await fetch(url, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(requestBody),\n                    signal,\n                });\n\n                if (!response.ok) {\n                    // 500 hatası - model yükleniyor olabilir, bekle ve tekrar dene\n                    if (response.status === 500 && attempt < maxRetries) {\n                        console.log(`[LocalAI] 500 error, retrying in ${attempt * 3}s... (attempt ${attempt}/${maxRetries})`);\n                        await new Promise(resolve => setTimeout(resolve, attempt * 3000));\n                        continue;\n                    }\n                    throw new Error(`Ollama API error: ${response.status} ${response.statusText}`);\n                }\n\n                // Başarılı response - devam et\n                return await this.processResponse(response, useStreaming, onToken);\n            } catch (error) {\n                lastError = error as Error;\n\n                // Abort hatası - retry yapma\n                if (error instanceof DOMException && error.name === 'AbortError') {\n                    throw error;\n                }\n\n                // Network hatası veya timeout - retry\n                if (attempt < maxRetries) {\n                    console.log(`[LocalAI] Request failed, retrying in ${attempt * 3}s... (attempt ${attempt}/${maxRetries}):`, error);\n                    await new Promise(resolve => setTimeout(resolve, attempt * 3000));\n                    continue;\n                }\n            }\n        }\n\n        throw lastError || new Error('Request failed after retries');\n    }\n\n    private async processResponse(\n        response: Response,\n        useStreaming: boolean,\n        onToken?: (token: string) => void\n    ): Promise<{ content: string; toolCalls: ToolCall[] }> {\n\n        let fullContent = '';\n        let toolCalls: ToolCall[] = [];\n\n        if (!useStreaming) {\n            // Non-streaming: tek bir JSON response\n            const json = await response.json() as OllamaChatResponse;\n            console.log('[LocalAI] Non-streaming response:', JSON.stringify(json, null, 2));\n\n            if (json.message?.content) {\n                fullContent = json.message.content;\n                onToken?.(json.message.content);\n            }\n            if (json.message?.tool_calls) {\n                console.log('[LocalAI] Tool calls received:', JSON.stringify(json.message.tool_calls));\n                toolCalls = json.message.tool_calls;\n            }\n\n            // Eğer native tool_calls boşsa, content içinden JSON tool call parse etmeyi dene\n            if (toolCalls.length === 0 && fullContent) {\n                const parsedToolCalls = this.parseToolCallsFromContent(fullContent);\n                if (parsedToolCalls.length > 0) {\n                    console.log('[LocalAI] Parsed tool calls from content:', JSON.stringify(parsedToolCalls));\n                    toolCalls = parsedToolCalls;\n                    // Tool call content'ini temizle (kullanıcıya göstermeye gerek yok)\n                    fullContent = '';\n                }\n            }\n        } else {\n            // Streaming: satır satır JSON\n            if (!response.body) {\n                throw new Error('No response body');\n            }\n\n            const reader = response.body.getReader();\n            const decoder = new TextDecoder();\n\n            while (true) {\n                const { done, value } = await reader.read();\n                if (done) break;\n\n                const chunk = decoder.decode(value, { stream: true });\n                const lines = chunk.split('\\n').filter(line => line.trim());\n\n                for (const line of lines) {\n                    try {\n                        const json: OllamaChatResponse = JSON.parse(line);\n                        if (json.message?.content) {\n                            fullContent += json.message.content;\n                            onToken?.(json.message.content);\n                        }\n                        if (json.message?.tool_calls) {\n                            console.log('[LocalAI] Tool calls received:', JSON.stringify(json.message.tool_calls));\n                            toolCalls = json.message.tool_calls;\n                        }\n                    } catch {\n                        // Skip invalid JSON lines\n                    }\n                }\n            }\n        }\n\n        console.log('[LocalAI] Chat response:', {\n            contentLength: fullContent.length,\n            toolCallCount: toolCalls.length,\n            toolCalls: toolCalls.map(tc => tc.function?.name)\n        });\n\n        return { content: fullContent, toolCalls };\n    }\n\n    async chat(\n        model: string,\n        messages: OllamaMessage[],\n        onToken?: (token: string) => void\n    ): Promise<string> {\n        const result = await this.chatWithTools(model, messages, [], onToken);\n        return result.content;\n    }\n\n    async listModels(): Promise<string[]> {\n        const url = `${this.baseUrl}/api/tags`;\n        console.log('[LocalAI] Fetching models from:', url);\n\n        try {\n            const response = await fetch(url);\n            console.log('[LocalAI] Response status:', response.status);\n\n            if (!response.ok) {\n                throw new Error(`Failed to list models: ${response.status}`);\n            }\n\n            const data = await response.json() as { models: Array<{ name: string }> };\n            console.log('[LocalAI] Models data:', data);\n            return data.models?.map(m => m.name) || [];\n        } catch (err) {\n            console.error('[LocalAI] Fetch error:', err);\n            throw err;\n        }\n    }\n\n    async isAvailable(): Promise<boolean> {\n        try {\n            const response = await fetch(`${this.baseUrl}/api/tags`);\n            return response.ok;\n        } catch {\n            return false;\n        }\n    }\n\n    // Content içinden JSON tool call'larını parse et\n    // Bazı modeller native tool_calls yerine content içinde JSON döndürüyor\n    private parseToolCallsFromContent(content: string): ToolCall[] {\n        const toolCalls: ToolCall[] = [];\n\n        // Helper: tek bir tool call objesini parse et\n        const parseToolCall = (obj: Record<string, unknown>): ToolCall | null => {\n            const name = obj.name as string;\n            // arguments veya parameters olabilir\n            const args = (obj.arguments || obj.parameters) as Record<string, string>;\n            if (name && args && typeof args === 'object') {\n                return {\n                    function: {\n                        name,\n                        arguments: args\n                    }\n                };\n            }\n            return null;\n        };\n\n        try {\n            // 1. Markdown code block içindeki JSON'u bul\n            const codeBlockMatch = content.match(/```(?:json)?\\s*([\\s\\S]*?)```/);\n            if (codeBlockMatch) {\n                const parsed = JSON.parse(codeBlockMatch[1].trim());\n                if (Array.isArray(parsed)) {\n                    for (const item of parsed) {\n                        const tc = parseToolCall(item);\n                        if (tc) toolCalls.push(tc);\n                    }\n                } else {\n                    const tc = parseToolCall(parsed);\n                    if (tc) toolCalls.push(tc);\n                }\n                if (toolCalls.length > 0) return toolCalls;\n            }\n\n            // 2. Content içinde { ile başlayan JSON objesi ara\n            const jsonObjectMatch = content.match(/\\{[\\s\\S]*\"name\"\\s*:\\s*\"(\\w+)\"[\\s\\S]*\\}/);\n            if (jsonObjectMatch) {\n                try {\n                    const parsed = JSON.parse(jsonObjectMatch[0]);\n                    const tc = parseToolCall(parsed);\n                    if (tc) toolCalls.push(tc);\n                    if (toolCalls.length > 0) return toolCalls;\n                } catch {\n                    // Continue to next method\n                }\n            }\n\n            // 3. Content'in tamamı JSON olabilir\n            const trimmed = content.trim();\n            if (trimmed.startsWith('{') || trimmed.startsWith('[')) {\n                const parsed = JSON.parse(trimmed);\n                if (Array.isArray(parsed)) {\n                    for (const item of parsed) {\n                        const tc = parseToolCall(item);\n                        if (tc) toolCalls.push(tc);\n                    }\n                } else {\n                    const tc = parseToolCall(parsed);\n                    if (tc) toolCalls.push(tc);\n                }\n            }\n        } catch {\n            // JSON parse hatası - tool call yok\n        }\n\n        return toolCalls;\n    }\n}\n","import * as vscode from 'vscode';\nimport * as path from 'path';\nimport * as fs from 'fs';\nimport { OllamaTool } from './ollama';\n\n// Pending edit storage for diff approval\nexport interface PendingEdit {\n    id: string;\n    filePath: string;\n    relativePath: string;\n    oldContent: string;\n    newContent: string;\n    oldText: string;\n    newText: string;\n    timestamp: number;\n}\n\nlet pendingEdits: Map<string, PendingEdit> = new Map();\n\n// Event emitter for pending edits changes\ntype PendingEditsListener = () => void;\nconst pendingEditsListeners: PendingEditsListener[] = [];\n\nfunction notifyPendingEditsChanged(): void {\n    pendingEditsListeners.forEach(listener => listener());\n}\n\nexport function onPendingEditsChanged(listener: PendingEditsListener): vscode.Disposable {\n    pendingEditsListeners.push(listener);\n    return new vscode.Disposable(() => {\n        const index = pendingEditsListeners.indexOf(listener);\n        if (index >= 0) {\n            pendingEditsListeners.splice(index, 1);\n        }\n    });\n}\n\nexport function getPendingEdit(id: string): PendingEdit | undefined {\n    return pendingEdits.get(id);\n}\n\n// Get pending edit by file path (checks temp files too)\nexport function getPendingEditForFile(filePath: string): PendingEdit | undefined {\n    // Check if this is a temp diff file\n    const tempDir = path.join(require('os').tmpdir(), 'localai-diff');\n    if (filePath.startsWith(tempDir)) {\n        // Extract edit ID from filename\n        const fileName = path.basename(filePath);\n        const match = fileName.match(/^(edit_\\d+_\\w+)_/);\n        if (match) {\n            return pendingEdits.get(match[1]);\n        }\n    }\n\n    // Check if there's a pending edit for this actual file\n    for (const edit of pendingEdits.values()) {\n        if (edit.filePath === filePath) {\n            return edit;\n        }\n    }\n\n    return undefined;\n}\n\nexport function clearPendingEdit(id: string): void {\n    pendingEdits.delete(id);\n    notifyPendingEditsChanged();\n}\n\nexport async function applyPendingEdit(id: string): Promise<string> {\n    const edit = pendingEdits.get(id);\n    if (!edit) {\n        return 'Error: Edit not found or already applied';\n    }\n\n    try {\n        fs.writeFileSync(edit.filePath, edit.newContent, 'utf-8');\n        const doc = await vscode.workspace.openTextDocument(edit.filePath);\n        await vscode.window.showTextDocument(doc, { preview: false });\n        pendingEdits.delete(id);\n        cleanupTempFiles(id);\n        // Close diff editor tabs\n        await closeDiffEditors(id);\n        notifyPendingEditsChanged();\n        return `✓ Applied changes to ${edit.relativePath}`;\n    } catch (error) {\n        return `Error: ${error instanceof Error ? error.message : 'Could not apply edit'}`;\n    }\n}\n\nexport async function rejectPendingEdit(id: string): Promise<string> {\n    const edit = pendingEdits.get(id);\n    if (!edit) {\n        return 'Edit not found';\n    }\n    pendingEdits.delete(id);\n    cleanupTempFiles(id);\n    // Close diff editor tabs\n    await closeDiffEditors(id);\n    notifyPendingEditsChanged();\n    return `✗ Rejected changes to ${edit.relativePath}`;\n}\n\nexport function getAllPendingEdits(): PendingEdit[] {\n    return Array.from(pendingEdits.values());\n}\n\nexport async function applyAllPendingEdits(): Promise<string> {\n    const edits = getAllPendingEdits();\n    if (edits.length === 0) {\n        return 'No pending edits to apply';\n    }\n\n    const results: string[] = [];\n    for (const edit of edits) {\n        try {\n            fs.writeFileSync(edit.filePath, edit.newContent, 'utf-8');\n            pendingEdits.delete(edit.id);\n            cleanupTempFiles(edit.id);\n            await closeDiffEditors(edit.id);\n            results.push(`✓ ${edit.relativePath}`);\n        } catch (error) {\n            results.push(`✗ ${edit.relativePath}: ${error instanceof Error ? error.message : 'Failed'}`);\n        }\n    }\n\n    return `Applied ${results.filter(r => r.startsWith('✓')).length}/${edits.length} edits:\\n${results.join('\\n')}`;\n}\n\nexport async function rejectAllPendingEdits(): Promise<string> {\n    const edits = getAllPendingEdits();\n    const count = edits.length;\n\n    for (const edit of edits) {\n        cleanupTempFiles(edit.id);\n        await closeDiffEditors(edit.id);\n    }\n\n    pendingEdits.clear();\n    return `✗ Rejected ${count} pending edit(s)`;\n}\n\nexport function getPendingEditsCount(): number {\n    return pendingEdits.size;\n}\n\n// Temp directory for diff files\nconst tempDiffDir = path.join(require('os').tmpdir(), 'localai-diff');\n\n// Ensure temp dir exists\nfunction ensureTempDir(): void {\n    if (!fs.existsSync(tempDiffDir)) {\n        fs.mkdirSync(tempDiffDir, { recursive: true });\n    }\n}\n\n// Show VSCode native diff editor\nasync function showVSCodeDiff(editId: string, filePath: string, relativePath: string, oldContent: string, newContent: string): Promise<void> {\n    ensureTempDir();\n\n    // Create temp files for diff\n    const originalFile = path.join(tempDiffDir, `${editId}_original${path.extname(filePath)}`);\n    const modifiedFile = path.join(tempDiffDir, `${editId}_modified${path.extname(filePath)}`);\n\n    fs.writeFileSync(originalFile, oldContent, 'utf-8');\n    fs.writeFileSync(modifiedFile, newContent, 'utf-8');\n\n    const originalUri = vscode.Uri.file(originalFile);\n    const modifiedUri = vscode.Uri.file(modifiedFile);\n\n    // Open VSCode diff editor\n    await vscode.commands.executeCommand('vscode.diff',\n        originalUri,\n        modifiedUri,\n        `${relativePath} (Proposed Changes - ${editId.slice(-6)})`\n    );\n}\n\n// Clean up temp files for an edit\nfunction cleanupTempFiles(editId: string): void {\n    try {\n        const files = fs.readdirSync(tempDiffDir);\n        files.filter(f => f.startsWith(editId)).forEach(f => {\n            fs.unlinkSync(path.join(tempDiffDir, f));\n        });\n    } catch {\n        // Ignore cleanup errors\n    }\n}\n\n// Close diff editor tabs for a specific edit\nasync function closeDiffEditors(editId: string): Promise<void> {\n    const tabs = vscode.window.tabGroups.all.flatMap(group => group.tabs);\n    for (const tab of tabs) {\n        if (tab.label.includes(editId.slice(-6))) {\n            const tabInput = tab.input;\n            if (tabInput) {\n                await vscode.window.tabGroups.close(tab);\n            }\n        }\n    }\n}\n\n// Generate simple diff summary for chat display\nfunction generateDiffSummary(oldText: string, newText: string, filePath: string): string {\n    const oldLines = oldText.split('\\n');\n    const newLines = newText.split('\\n');\n\n    let additions = 0;\n    let deletions = 0;\n\n    // Count changed lines\n    const maxLen = Math.max(oldLines.length, newLines.length);\n    for (let i = 0; i < maxLen; i++) {\n        if (oldLines[i] !== newLines[i]) {\n            if (oldLines[i] !== undefined) deletions++;\n            if (newLines[i] !== undefined) additions++;\n        }\n    }\n\n    return `📝 ${filePath}: +${additions} -${deletions} lines`;\n}\n\nexport interface Tool {\n    name: string;\n    description: string;\n    parameters: {\n        type: string;\n        properties: Record<string, { type: string; description: string }>;\n        required: string[];\n    };\n    execute: (params: Record<string, string>) => Promise<string>;\n}\n\n// Parametre normalizasyonu - modeller farklı isimler kullanabilir\nfunction normalizeParams(params: Record<string, string>): Record<string, string> {\n    const normalized = { ...params };\n\n    // path alternatifleri\n    if (!normalized.path) {\n        normalized.path = params.file_path || params.filepath || params.file || params.filename || params.name || '';\n    }\n\n    // content alternatifleri\n    if (!normalized.content) {\n        normalized.content = params.code || params.text || params.data || params.body || '';\n    }\n\n    // old_text alternatifleri\n    if (!normalized.old_text) {\n        normalized.old_text = params.oldText || params.old || params.find || params.search || params.original || '';\n    }\n\n    // new_text alternatifleri\n    if (!normalized.new_text) {\n        normalized.new_text = params.newText || params.new || params.replace || params.replacement || '';\n    }\n\n    // command alternatifleri\n    if (!normalized.command) {\n        normalized.command = params.cmd || params.shell || params.exec || '';\n    }\n\n    // pattern alternatifleri (search_files için)\n    if (!normalized.pattern) {\n        normalized.pattern = params.query || params.search || params.regex || '';\n    }\n\n    return normalized;\n}\n\nexport const tools: Tool[] = [\n    {\n        name: 'read_file',\n        description: 'Read the contents of a file. Use this to understand code before making changes.',\n        parameters: {\n            type: 'object',\n            properties: {\n                path: {\n                    type: 'string',\n                    description: 'File path relative to project root'\n                },\n                start_line: {\n                    type: 'string',\n                    description: 'Optional: starting line number (1-indexed)'\n                },\n                end_line: {\n                    type: 'string',\n                    description: 'Optional: ending line number (1-indexed)'\n                }\n            },\n            required: ['path']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.path) {\n                return 'Error: path parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n            const filePath = path.join(workspaceRoot, params.path);\n            try {\n                const content = fs.readFileSync(filePath, 'utf-8');\n                const lines = content.split('\\n');\n\n                const startLine = params.start_line ? parseInt(params.start_line) - 1 : 0;\n                const endLine = params.end_line ? parseInt(params.end_line) : lines.length;\n\n                const selectedLines = lines.slice(startLine, endLine);\n                const numberedLines = selectedLines.map((line, i) =>\n                    `${(startLine + i + 1).toString().padStart(4)}: ${line}`\n                );\n\n                return `File: ${params.path}\\n${'─'.repeat(50)}\\n${numberedLines.join('\\n')}`;\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Could not read file'}`;\n            }\n        }\n    },\n    {\n        name: 'write_file',\n        description: 'Create a new file or completely overwrite an existing file. Shows diff preview for user approval.',\n        parameters: {\n            type: 'object',\n            properties: {\n                path: {\n                    type: 'string',\n                    description: 'File path relative to project root'\n                },\n                content: {\n                    type: 'string',\n                    description: 'Complete file content to write'\n                }\n            },\n            required: ['path', 'content']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.path) {\n                return 'Error: path parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            if (!params.content) {\n                return 'Error: content parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n            const filePath = path.join(workspaceRoot, params.path);\n            try {\n                const dir = path.dirname(filePath);\n                if (!fs.existsSync(dir)) {\n                    fs.mkdirSync(dir, { recursive: true });\n                }\n\n                // Get existing content if file exists\n                const oldContent = fs.existsSync(filePath)\n                    ? fs.readFileSync(filePath, 'utf-8')\n                    : '';\n                const newContent = params.content;\n\n                // Create pending edit for diff preview\n                const editId = `edit_${Date.now()}_${Math.random().toString(36).substring(2, 11)}`;\n                const pendingEdit: PendingEdit = {\n                    id: editId,\n                    filePath,\n                    relativePath: params.path,\n                    oldContent,\n                    newContent,\n                    oldText: oldContent,\n                    newText: newContent,\n                    timestamp: Date.now()\n                };\n                pendingEdits.set(editId, pendingEdit);\n                notifyPendingEditsChanged();\n\n                // Show VSCode native diff editor\n                await showVSCodeDiff(editId, filePath, params.path, oldContent, newContent);\n\n                // Return summary for chat\n                const isNewFile = oldContent === '';\n                const summary = isNewFile\n                    ? `📄 New file: ${params.path} (${newContent.split('\\n').length} lines)`\n                    : generateDiffSummary(oldContent, newContent, params.path);\n                return `PENDING_EDIT:${editId}\\n${summary}\\n\\n👆 VSCode diff editor açıldı. Değişiklikleri inceleyin.`;\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Could not write file'}`;\n            }\n        }\n    },\n    {\n        name: 'edit_file',\n        description: 'Replace text in a file. Shows diff preview for user approval before applying changes.',\n        parameters: {\n            type: 'object',\n            properties: {\n                path: {\n                    type: 'string',\n                    description: 'File path relative to project root'\n                },\n                old_text: {\n                    type: 'string',\n                    description: 'Exact text to find (must match exactly including whitespace)'\n                },\n                new_text: {\n                    type: 'string',\n                    description: 'New text to replace with'\n                }\n            },\n            required: ['path', 'old_text', 'new_text']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.path) {\n                return 'Error: path parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            if (!params.old_text) {\n                return 'Error: old_text parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            if (!params.new_text && params.new_text !== '') {\n                return 'Error: new_text parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n            const filePath = path.join(workspaceRoot, params.path);\n\n            // Check if file exists\n            if (!fs.existsSync(filePath)) {\n                const files = fs.readdirSync(workspaceRoot);\n                const suggestions = files.filter(f => f.includes(params.path.replace(/^\\.\\//, '').split('/').pop() || ''));\n                return `Error: File not found: ${params.path}\\n\\nFiles in project root:\\n${files.slice(0, 20).map(f => '  ' + f).join('\\n')}${suggestions.length > 0 ? '\\n\\nDid you mean: ' + suggestions.join(', ') : ''}`;\n            }\n\n            try {\n                const content = fs.readFileSync(filePath, 'utf-8');\n\n                if (!content.includes(params.old_text)) {\n                    const lines = content.split('\\n');\n                    const preview = lines.slice(0, 30).map((l, i) => `${i + 1}: ${l}`).join('\\n');\n                    return `Error: old_text not found in file.\\n\\nActual content of ${params.path}:\\n${'─'.repeat(40)}\\n${preview}${lines.length > 30 ? '\\n... (' + (lines.length - 30) + ' more lines)' : ''}\\n${'─'.repeat(40)}\\n\\nCopy the EXACT text you want to replace from above.`;\n                }\n\n                const newContent = content.replace(params.old_text, params.new_text);\n\n                // Create pending edit\n                const editId = `edit_${Date.now()}_${Math.random().toString(36).substring(2, 11)}`;\n                const pendingEdit: PendingEdit = {\n                    id: editId,\n                    filePath,\n                    relativePath: params.path,\n                    oldContent: content,\n                    newContent,\n                    oldText: params.old_text,\n                    newText: params.new_text,\n                    timestamp: Date.now()\n                };\n                pendingEdits.set(editId, pendingEdit);\n                notifyPendingEditsChanged();\n\n                // Show VSCode native diff editor\n                await showVSCodeDiff(editId, filePath, params.path, content, newContent);\n\n                // Return summary for chat\n                const summary = generateDiffSummary(content, newContent, params.path);\n                return `PENDING_EDIT:${editId}\\n${summary}\\n\\n👆 VSCode diff editor açıldı. Değişiklikleri inceleyin.`;\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Could not edit file'}`;\n            }\n        }\n    },\n    {\n        name: 'list_files',\n        description: 'List files and folders in a directory. Use to explore project structure.',\n        parameters: {\n            type: 'object',\n            properties: {\n                path: {\n                    type: 'string',\n                    description: 'Directory path relative to project root (use \".\" for root)'\n                },\n                recursive: {\n                    type: 'string',\n                    description: 'Set to \"true\" to list recursively (max 3 levels)'\n                }\n            },\n            required: ['path']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n            const dirPath = path.join(workspaceRoot, params.path || '.');\n            const recursive = params.recursive === 'true';\n\n            const ignoreDirs = ['node_modules', '.git', 'dist', 'out', '.vscode', '__pycache__', 'venv'];\n\n            function listDir(dir: string, prefix: string = '', depth: number = 0): string[] {\n                if (depth > 3) return [];\n\n                const entries = fs.readdirSync(dir, { withFileTypes: true });\n                const results: string[] = [];\n\n                for (const entry of entries) {\n                    if (entry.name.startsWith('.') && entry.name !== '.env') continue;\n                    if (ignoreDirs.includes(entry.name)) continue;\n\n                    const isDir = entry.isDirectory();\n                    results.push(`${prefix}${isDir ? '📁 ' : '📄 '}${entry.name}`);\n\n                    if (isDir && recursive) {\n                        const subPath = path.join(dir, entry.name);\n                        results.push(...listDir(subPath, prefix + '  ', depth + 1));\n                    }\n                }\n                return results;\n            }\n\n            try {\n                const result = listDir(dirPath);\n                return result.length > 0 ? result.join('\\n') : 'Empty directory';\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Could not list directory'}`;\n            }\n        }\n    },\n    {\n        name: 'grep',\n        description: 'Search for text/pattern in files. Returns matching lines with file paths and line numbers.',\n        parameters: {\n            type: 'object',\n            properties: {\n                pattern: {\n                    type: 'string',\n                    description: 'Text or regex pattern to search for'\n                },\n                path: {\n                    type: 'string',\n                    description: 'Directory to search in (default: project root)'\n                },\n                file_pattern: {\n                    type: 'string',\n                    description: 'File glob pattern like \"*.ts\" or \"*.py\" (default: all files)'\n                }\n            },\n            required: ['pattern']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.pattern) {\n                return 'Error: pattern parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n\n            const searchPath = params.path ? path.join(workspaceRoot, params.path) : workspaceRoot;\n            const filePattern = params.file_pattern || '**/*';\n            const results: string[] = [];\n            const maxResults = 50;\n\n            const ignoreDirs = ['node_modules', '.git', 'dist', 'out', '__pycache__'];\n\n            function searchInDir(dir: string) {\n                if (results.length >= maxResults) return;\n\n                const entries = fs.readdirSync(dir, { withFileTypes: true });\n\n                for (const entry of entries) {\n                    if (results.length >= maxResults) break;\n                    if (ignoreDirs.includes(entry.name)) continue;\n                    if (entry.name.startsWith('.')) continue;\n\n                    const fullPath = path.join(dir, entry.name);\n\n                    if (entry.isDirectory()) {\n                        searchInDir(fullPath);\n                    } else if (entry.isFile()) {\n                        // Check file pattern\n                        if (params.file_pattern) {\n                            const ext = params.file_pattern.replace('*', '');\n                            if (!entry.name.endsWith(ext)) continue;\n                        }\n\n                        try {\n                            const content = fs.readFileSync(fullPath, 'utf-8');\n                            const lines = content.split('\\n');\n                            const regex = new RegExp(params.pattern, 'gi');\n\n                            lines.forEach((line, i) => {\n                                if (results.length >= maxResults) return;\n                                if (regex.test(line)) {\n                                    const relPath = path.relative(workspaceRoot!, fullPath);\n                                    results.push(`${relPath}:${i + 1}: ${line.trim()}`);\n                                }\n                                regex.lastIndex = 0; // Reset regex\n                            });\n                        } catch {\n                            // Skip binary files\n                        }\n                    }\n                }\n            }\n\n            try {\n                searchInDir(searchPath);\n                if (results.length === 0) {\n                    return `No matches found for \"${params.pattern}\"`;\n                }\n                return `Found ${results.length} match(es):\\n${'─'.repeat(50)}\\n${results.join('\\n')}`;\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Search failed'}`;\n            }\n        }\n    },\n    {\n        name: 'get_selection',\n        description: 'Get the currently selected text in the active editor',\n        parameters: {\n            type: 'object',\n            properties: {},\n            required: []\n        },\n        execute: async () => {\n            const editor = vscode.window.activeTextEditor;\n            if (!editor) {\n                return 'No active editor';\n            }\n\n            const selection = editor.selection;\n            const selectedText = editor.document.getText(selection);\n\n            if (!selectedText) {\n                return 'No text selected';\n            }\n\n            const fileName = path.basename(editor.document.fileName);\n            const startLine = selection.start.line + 1;\n            const endLine = selection.end.line + 1;\n\n            return `Selected text from ${fileName} (lines ${startLine}-${endLine}):\\n${'─'.repeat(50)}\\n${selectedText}`;\n        }\n    },\n    {\n        name: 'get_open_file',\n        description: 'Get the full content of the currently open file in editor',\n        parameters: {\n            type: 'object',\n            properties: {},\n            required: []\n        },\n        execute: async () => {\n            const editor = vscode.window.activeTextEditor;\n            if (!editor) {\n                return 'No file is open';\n            }\n            const fileName = path.basename(editor.document.fileName);\n            const content = editor.document.getText();\n            const lines = content.split('\\n');\n            const numberedLines = lines.map((line, i) =>\n                `${(i + 1).toString().padStart(4)}: ${line}`\n            );\n            return `File: ${fileName}\\n${'─'.repeat(50)}\\n${numberedLines.join('\\n')}`;\n        }\n    },\n    {\n        name: 'run_terminal_command',\n        description: 'Run a shell command. Use for npm, git, build commands etc.',\n        parameters: {\n            type: 'object',\n            properties: {\n                command: {\n                    type: 'string',\n                    description: 'Shell command to run'\n                }\n            },\n            required: ['command']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.command) {\n                return 'Error: command parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            return new Promise((resolve) => {\n                const { exec } = require('child_process');\n                const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath || '';\n\n                exec(params.command, { cwd: workspaceRoot, timeout: 30000 }, (error: Error | null, stdout: string, stderr: string) => {\n                    if (error) {\n                        resolve(`Error: ${error.message}\\n${stderr}`);\n                    } else {\n                        const output = stdout || stderr || 'Command completed (no output)';\n                        resolve(`$ ${params.command}\\n${'─'.repeat(50)}\\n${output}`);\n                    }\n                });\n            });\n        }\n    },\n    {\n        name: 'show_diff',\n        description: 'Show a diff preview of changes without applying them',\n        parameters: {\n            type: 'object',\n            properties: {\n                path: {\n                    type: 'string',\n                    description: 'File path'\n                },\n                new_content: {\n                    type: 'string',\n                    description: 'Proposed new content'\n                }\n            },\n            required: ['path', 'new_content']\n        },\n        execute: async (rawParams) => {\n            const params = normalizeParams(rawParams);\n            if (!params.path) {\n                return 'Error: path parameter is required. Received: ' + JSON.stringify(rawParams);\n            }\n            const workspaceRoot = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n            if (!workspaceRoot) {\n                return 'Error: No workspace folder open';\n            }\n\n            const filePath = path.join(workspaceRoot, params.path);\n\n            try {\n                const oldContent = fs.existsSync(filePath)\n                    ? fs.readFileSync(filePath, 'utf-8')\n                    : '';\n\n                const oldLines = oldContent.split('\\n');\n                const newLines = (params.new_content || '').split('\\n');\n\n                const diff: string[] = [`Diff for ${params.path}:`, '─'.repeat(50)];\n\n                const maxLines = Math.max(oldLines.length, newLines.length);\n                for (let i = 0; i < maxLines; i++) {\n                    const oldLine = oldLines[i] || '';\n                    const newLine = newLines[i] || '';\n\n                    if (oldLine !== newLine) {\n                        if (oldLines[i] !== undefined) {\n                            diff.push(`- ${i + 1}: ${oldLine}`);\n                        }\n                        if (newLines[i] !== undefined) {\n                            diff.push(`+ ${i + 1}: ${newLine}`);\n                        }\n                    }\n                }\n\n                return diff.join('\\n');\n            } catch (error) {\n                return `Error: ${error instanceof Error ? error.message : 'Could not generate diff'}`;\n            }\n        }\n    }\n];\n\n// Convert to Ollama tool format\nexport function getOllamaTools(): OllamaTool[] {\n    return tools.map(t => ({\n        type: 'function' as const,\n        function: {\n            name: t.name,\n            description: t.description,\n            parameters: t.parameters\n        }\n    }));\n}\n\n// System prompt for tool-enabled chat\nexport function getSystemPrompt(): string {\n    return `Sen bir kod yazma asistanısın. Kullanıcının istediği uygulamayı TAMAMEN oluşturmalısın.\n\n## DAVRANIŞIN:\n1. Kullanıcı bir şey istediğinde, HEMEN tool kullanarak dosya oluştur\n2. Yarıda bırakma - tüm dosyaları oluşturana kadar devam et\n3. Geri bildirim bekleme - dosyaları oluştur ve devam et\n4. Her zaman write_file tool'unu kullan, sadece açıklama yazma\n\n## TOOL KULLANIMI:\n\n### Yeni dosya oluşturmak için:\nwrite_file tool'unu çağır:\n- path: dosya yolu (örn: \"src/App.tsx\")\n- content: dosyanın tam içeriği\n\n### Var olan dosyayı düzenlemek için:\n1. ÖNCE read_file ile dosyayı oku\n2. SONRA edit_file ile değiştir (old_text birebir aynı olmalı)\n\n### Proje yapısını görmek için:\nlist_files tool'unu kullan\n\n### Komut çalıştırmak için:\nrun_terminal_command tool'unu kullan\n\n## ÖNEMLİ:\n- Her istekte EN AZ BİR tool çağır\n- Sadece metin yazma, tool kullan!\n- Dosya oluşturmak için write_file KULLANMALISIN\n\n## ÖRNEK:\nKullanıcı: \"React todo app yap\"\n\nYapman gereken:\n1. write_file(path=\"src/App.jsx\", content=\"import React...\")\n2. write_file(path=\"src/components/TodoList.jsx\", content=\"...\")\n3. write_file(path=\"src/App.css\", content=\"...\")\n\nSADECE METİN YAZMA - TOOL KULLAN!`;\n}\n\nexport async function executeTool(name: string, params: Record<string, string>): Promise<string> {\n    const tool = tools.find(t => t.name === name);\n    if (!tool) {\n        return `Unknown tool: ${name}`;\n    }\n    return await tool.execute(params);\n}\n","module.exports = require(\"os\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(265);\n"],"names":["CHAT_HISTORY_KEY","CURRENT_SESSION_KEY","PROJECT_MEMORY_KEY","context","currentSession","constructor","this","createNewSession","model","session","id","Date","now","Math","random","toString","substr","title","messages","createdAt","updatedAt","saveCurrentSessionId","getCurrentSession","loadCurrentSession","sessionId","workspaceState","get","getAllSessions","find","s","saveSession","length","firstUserMsg","m","role","content","substring","sessions","existingIndex","findIndex","unshift","trimmedSessions","slice","update","deleteSession","filtered","filter","undefined","clearAllSessions","addMessage","message","push","getMessages","clearCurrentMessages","getProjectMemory","data","knownFiles","Map","Object","entries","projectNotes","commonCommands","saveProjectMemory","memory","fromEntries","addFileNote","filePath","note","set","setProjectNotes","notes","addCommonCommand","command","includes","getContextSummary","parts","size","files","Array","from","map","path","join","exportHistory","exportData","exportedAt","toISOString","projectMemory","JSON","stringify","importHistory","jsonData","parse","isArray","success","console","log","statusBarItem","vscode","window","createStatusBarItem","StatusBarAlignment","Left","name","subscriptions","memoryService","MemoryService","openChatCommand","commands","registerCommand","ChatPanel","createOrShow","extensionUri","applyEditCommand","async","activeEditor","activeTextEditor","pendingEdit","getPendingEditForFile","document","uri","fsPath","allEdits","getAllPendingEdits","result","applyPendingEdit","showInformationMessage","updatePendingEditContext","showWarningMessage","rejectEditCommand","rejectPendingEdit","hasPending","getPendingEditsCount","executeCommand","onDidChangeActiveTextEditor","onPendingEditsChanged","stopGenerationCommand","currentPanel","stopGeneration","dispose","text","tooltip","backgroundColor","ThemeColor","show","elapsed","hide","setTimeout","module","exports","require","static","panel","ollama","agentModel","coderModel","abortController","waitingForApproval","lastPendingCount","autoApproveMode","disposables","OllamaService","webview","html","getHtmlContent","currentCount","continueAfterApproval","updatePendingEditsCount","onDidReceiveMessage","handleUserMessage","sendModelList","setBaseUrl","url","loadSession","sendSessionList","initSession","postMessage","messageCount","approveResult","editId","approved","rejectResult","approveAllResult","applyAllPendingEdits","rejectAllResult","rejectAllPendingEdits","enabled","handleGetContext","type","value","openFile","line","onDidDispose","column","ViewColumn","Beside","reveal","createWebviewPanel","enableScripts","retainContextWhenHidden","localResourceRoots","abort","hideGeneratingStatus","existingSession","currentSessionId","saveCurrentSession","count","workspaceRoot","workspace","workspaceFolders","editor","getText","selection","fileName","repeat","diagnostics","languages","getDiagnostics","d","range","start","severity","replace","fullPath","fs","existsSync","readFileSync","error","Error","Uri","file","startsWith","doc","openTextDocument","showTextDocument","position","Position","Selection","revealRange","Range","TextEditorRevealType","InCenter","showErrorMessage","models","listModels","toolCapable","some","tc","toLowerCase","fullMessage","contextParts","c","label","runAgentLoop","token","iteration","statusUpdateInterval","loopStartTime","AbortController","activeAgentModel","showGeneratingStatus","setInterval","updateGeneratingStatus","floor","signal","aborted","DOMException","messagesWithSystem","getSystemPrompt","tools","getOllamaTools","toolCalls","chatWithTools","tool_calls","toolCall","toolName","function","toolParams","arguments","codeContent","generateCodeWithCoderModel","displayParams","split","new_text","old_text","params","toolResult","executeTool","displayResult","clearInterval","showReadyStatus","userMessages","lastUserMessage","coderPrompt","cleanCode","trim","codeBlockMatch","match","pop","baseUrl","getBaseUrl","getConfiguration","updateBaseUrl","getCurrentUrl","onToken","useStreaming","requestBody","stream","toolCount","toolNames","t","lastError","attempt","response","fetch","method","headers","body","ok","status","Promise","resolve","statusText","processResponse","fullContent","reader","getReader","decoder","TextDecoder","done","read","lines","decode","json","parsedToolCalls","parseToolCallsFromContent","contentLength","toolCallCount","chat","err","isAvailable","parseToolCall","obj","args","parameters","parsed","item","jsonObjectMatch","trimmed","listener","pendingEditsListeners","Disposable","index","indexOf","splice","pendingEdits","tempDir","basename","edit","values","delete","notifyPendingEditsChanged","writeFileSync","newContent","preview","cleanupTempFiles","closeDiffEditors","relativePath","edits","results","r","clear","description","tool","execute","forEach","tempDiffDir","showVSCodeDiff","oldContent","mkdirSync","recursive","originalFile","extname","modifiedFile","originalUri","modifiedUri","readdirSync","f","unlinkSync","tabs","tabGroups","all","flatMap","group","tab","input","close","generateDiffSummary","oldText","newText","oldLines","newLines","additions","deletions","maxLen","max","i","normalizeParams","normalized","file_path","filepath","filename","code","old","search","original","new","replacement","cmd","shell","exec","pattern","query","regex","properties","start_line","end_line","required","rawParams","startLine","parseInt","endLine","numberedLines","padStart","dir","dirname","timestamp","suggestions","l","dirPath","ignoreDirs","listDir","prefix","depth","withFileTypes","entry","isDir","isDirectory","subPath","file_pattern","searchPath","searchInDir","isFile","ext","endsWith","RegExp","test","relPath","relative","lastIndex","selectedText","end","cwd","timeout","stdout","stderr","output","new_content","diff","maxLines","oldLine","newLine","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"ignoreList":[],"sourceRoot":""}